import React, { useState, useEffect } from "react";
import StripeCheckout from "react-stripe-checkout";
import axios from "axios";
import { useNavigate } from "react-router-dom";

const KEY =
  "pk_test_51KfjKPGcr3GG0vZYIAaCKgfiFXLeq6kwkBaenU3FMLd4BTC7e1iY2M0yGnpfApmnAqRaNdYx0fqrsKnz9idFxpK600kt7KKMul";
const Pay = () => {
  let navigate = useNavigate();
  const [stripeToken, setStripeToken] = useState(null);
  const onToken = (token) => {
    setStripeToken(token);
  };
  useEffect(() => {
    const makeRequest = async () => {
      try {
        const res = await axios.post(
          "http://localhost:5000/api/checkout/payment",
          { tokenId: stripeToken.id, amount: 2000 }
        );
        console.log(res.data);
        navigate("/success", { replace: true });
      } catch (err) {
        console.log(err);
      }
    };
    stripeToken && makeRequest();
  }, [stripeToken, navigate]);

  return (
    <div>
      {stripeToken ? (
        <span>Processing. please wait...</span>
      ) : (
        <StripeCheckout
          name="EgyLook"
          image="data:image/jpeg;base64,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"
          stripeKey={KEY}
          billingAddress
          shippingAddress
          description="Your total is $20"
          amount={2000}
          token={onToken}
        />
      )}
    </div>
  );
};

export default Pay;
